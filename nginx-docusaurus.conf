# HTTP 服务器 - 支持通过 IP 和域名访问
server {
    listen 80;
    # 支持通过 IP 访问（_ 表示接受所有请求）
    # 也支持域名访问（如果配置了 DNS）
    server_name _ openjiuwen.com www.openjiuwen.com;
    
    # 如果需要启用 HTTPS 重定向（需要先配置 DNS 和证书）
    # return 301 https://$server_name$request_uri;
    
    # 网站根目录（指向构建后的 build 目录）
    root /opt/huawei/data/jiuwen/official_website/docusaurus/website/build;
    index index.html;
    
    # 日志文件位置
    access_log /var/log/nginx/docusaurus-access.log;
    error_log /var/log/nginx/docusaurus-error.log;
    
    # 支持客户端路由（SPA 路由）
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # 静态资源缓存（简化版本，不依赖正则表达式）
    location /assets/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
        access_log off;
    }
    
    # 禁止访问隐藏文件（简化版本）
    location /. {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    # Gzip 压缩（减少传输大小）
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_comp_level 6;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/xml+rss
        application/rss+xml
        font/truetype
        font/opentype
        application/vnd.ms-fontobject
        image/svg+xml;
}

# HTTPS 服务器（DNS 配置完成后启用）
# 获取 SSL 证书后，取消下面的注释并重新加载 Nginx
#server {
#    listen 443 ssl http2;
#    server_name openjiuwen.com www.openjiuwen.com;
#    
#    # SSL 证书配置（Let's Encrypt）
#    ssl_certificate /etc/letsencrypt/live/openjiuwen.com/fullchain.pem;
#    ssl_certificate_key /etc/letsencrypt/live/openjiuwen.com/privkey.pem;
#    
#    # SSL 配置（安全最佳实践）
#    ssl_protocols TLSv1.2 TLSv1.3;
#    ssl_ciphers HIGH:!aNULL:!MD5;
#    ssl_prefer_server_ciphers on;
#    ssl_session_cache shared:SSL:10m;
#    ssl_session_timeout 10m;
#    
#    # 网站根目录
#    root /opt/huawei/data/jiuwen/official_website/docusaurus/website/build;
#    index index.html;
#    
#    # 日志文件位置
#    access_log /var/log/nginx/docusaurus-access.log;
#    error_log /var/log/nginx/docusaurus-error.log;
#    
#    # 支持客户端路由（SPA 路由）
#    location / {
#        try_files $uri $uri/ /index.html;
#    }
#    
#    # 静态资源缓存
#    location /assets/ {
#        expires 1y;
#        add_header Cache-Control "public, immutable";
#        access_log off;
#    }
#    
#    # 禁止访问隐藏文件
#    location /. {
#        deny all;
#        access_log off;
#        log_not_found off;
#    }
#    
#    # Gzip 压缩
#    gzip on;
#    gzip_vary on;
#    gzip_min_length 1024;
#    gzip_comp_level 6;
#    gzip_types
#        text/plain
#        text/css
#        text/xml
#        text/javascript
#        application/json
#        application/javascript
#        application/xml+rss
#        application/rss+xml
#        font/truetype
#        font/opentype
#        application/vnd.ms-fontobject
#        image/svg+xml;
#}

